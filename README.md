# Modified-low-resolution-mesh
The mesh modification process involved a Python algorithm which has been developed to ensure that the coarser mesh kept the same volume for each water level as the high resolution bathymetry data representing the real river.
The algorithm is using the high resolution bathymetry data and the mesh file as input files. The mesh file contains the coordinates of the corners of each mesh cell used in the hydraulic simulation, and from now on referred to as mesh nodes.  In the modification algorithm, certain user-defined parameters play a crucial role. The first parameter is the 'Water Level Step,' which indicates the specific water levels to which the modification algorithm is applied.
The second parameter is the 'Vertical Tolerance,' implying that, to accommodate volume adjustments, the elevation of mesh nodes may vary by this value in either direction, resembling the dynamics of the riverbed, including dunes (1);
The first step after introducing the input files and parameters involves identifying approximately straight polylines that are perpendicular to the river baseline from the mesh nodes (Figure \ref{FIG:Fig3}{a}). The objective is to ensure that all mesh nodes are incorporated into these polylines (2);
The subsequent step is the first iteration among polylines. The polylines are processed one by one from downstream to upstream (3); The steps which are repeated through this iteration are numbered from 4 to 11.
The second iteration deals with varying water levels, starting from the lowest water level and progressing to the highest in each section (4); The steps which are repeated through this iteration are numbered from 5 to 11.
These water levels are determined initially for the downstream section using the water level step parameter which in this study, is 50 cm. However, due to the evolving geometry of the combined river, the depth and water levels are not uniform across all cross sections for a given discharge and it is not possible to use the water level step value for the rest of the sections along the river. Instead, a consistent value is maintained throughout all cross sections (\textbf{$d_{AR}$}), which is a combination of the flow area (\textit{A}) and hydraulic radius ( \textit{R}) determined by the Manning equation. 
\begin{equation}
    \ d_{AR}=A*R^{2/3}
\end{equation}
Therefore, following the determination of water levels for the most downstream cross-section, the associated value from equation (1) is computed for each water level. These values, which remain consistent for the other cross sections  for each specific discharge, facilitate the determination of the corresponding water levels at each cross-section.
The width of the flow is the other specific characteristic of each water level which is determined by identifying the points where the water level line intersects the banks of the cross-section. It is essential to note that when a side channel exists, the flow initially travels through the main channel. Once the main channel reaches full capacity, the side channel starts to flood. This is considered in the code. As illustrated in Figure \ref{FIG:Fig3}{c}, the water level is constrained within the main channel.
After understanding the water level characteristics and iterating through different water levels, specific points that are available for volume adjustment at each water level are identified, referred to as 'active elevation points'. Active elevation points are the mesh nodes located between the targeted water level and the previous targeted water level (5); In the 2D view of Figure \ref{FIG:Fig3}{c}, there is an example of active elevation points for a specific water level.
The next step involves the computation of the differences in volume for each water level. To achieve this, a polygon is defined for each water level (Figure \ref{FIG:Fig3}{a}). These polygons encompass the water level of the current iteration and the water level at the same water level step from the next upstream polyline (6); With the polygons defined, the next steps involve locating bathymetry points within these polygons (7); Subsequently, a closed surface is generated from the points and the water level plane for both mesh nodes and bathymetry points (8); This process enables volume calculation for both the bathymetry and low-resolution mesh (9), as well as the calculation of the difference between them (10);
The last step is to vertically adjust the active points within the allowed range to minimize the volume difference between the bathymetry and the low-resolution mesh. This allowed range is the "Vertical Tolerance" parameter which in this research is set at Â±30 cm, based on normal dunes occurring in the Waal River. The elevations of the active points for this specific water level are updated in the low-resolution mesh file (11); 
After finishing the two iterations, one among the polylines and one among the water levels for each polyline the  "modified low-resolution mesh" is created and is ready to be used in the simulations (12).
